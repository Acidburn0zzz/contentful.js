<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Contentful CDA SDK: Source: create-cda-api.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: create-cda-api.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = createCdaApi;

var _space = require('./entities/space');

var _contentType = require('./entities/content-type');

var _entry = require('./entities/entry');

var _asset = require('./entities/asset');

var _sync = require('./sync');

var _sync2 = _interopRequireDefault(_sync);

var _createRequestConfig = require('./create-request-config');

var _createRequestConfig2 = _interopRequireDefault(_createRequestConfig);

function _interopRequireDefault(obj) { return obj &amp;&amp; obj.__esModule ? obj : { default: obj }; }

/**
 * @memberof ContentfulCdaApi
 * @typedef {Object} ClientApi
 * @prop {function} getSpace
 * @prop {function} getContentType
 * @prop {function} getContentTypes
 * @prop {function} getEntry
 * @prop {function} getEntries
 * @prop {function} getAsset
 * @prop {function} getAssets
 * @prop {function} sync
 */

function errorHandler(error) {
  if (error.data) {
    throw error.data;
  }
  throw error;
}

/**
 * @private
 * Link resolution can be turned off for the methods that use it, or it can
 * be turned off globally. The local setting overrides the global setting.
 */


/**
 * Contentful CDA API
 * @namespace ContentfulCdaApi
 */

/**
 * @namespace Entities
 */

/**
 * Link to another entity
 * @memberof Entities
 * @typedef Link
 * @prop {string} type - type of this entity. Always link.
 * @prop {string} id
 * @prop {string} linkType - type of this link. If defined, either Entry or Asset
 */

/**
 * System metadata
 * @memberof Entities
 * @typedef Sys
 * @prop {string} type
 * @prop {string} id
 * @prop {Entities.Link} space
 * @prop {string} createdAt
 * @prop {string} updatedAt
 * @prop {number} revision
 */

function shouldLinksResolve(query, globalSetting) {
  return !!('resolveLinks' in query ? query.resolveLinks : globalSetting);
}

function createCdaApi(http, resolveLinksGlobalSetting) {
  function getSpace(id) {
    return http.get('').then(function (response) {
      return (0, _space.wrapSpace)(response.data);
    }, errorHandler);
  }

  /**
   * Gets a Content Type
   * @memberof ContentfulCdaApi
   * @param  {string} id
   * @return {Promise&lt;Entities.ContentType>} Promise for a Content Type
   */
  function getContentType(id) {
    return http.get('content_types/' + id).then(function (response) {
      return (0, _contentType.wrapContentType)(response.data);
    }, errorHandler);
  }

  /**
   * Gets a collection of Content Types
   * @memberof ContentfulCdaApi
   * @param  {Entities.Query} query
   * @return {Promise&lt;Entities.ContentTypeCollection>} Promise for a collection of Content Types
   */
  function getContentTypes() {
    var query = arguments.length &lt;= 0 || arguments[0] === undefined ? {} : arguments[0];

    return http.get('content_types', (0, _createRequestConfig2.default)({ query: query })).then(function (response) {
      return (0, _contentType.wrapContentTypeCollection)(response.data);
    }, errorHandler);
  }

  /**
   * Gets an Entry
   * @memberof ContentfulCdaApi
   * @param  {string} id
   * @return {Promise&lt;Entities.Entry>} Promise for an Entry
   */
  function getEntry(id) {
    return http.get('entries/' + id).then(function (response) {
      return (0, _entry.wrapEntry)(response.data);
    }, errorHandler);
  }

  /**
   * Gets a collection of Entries
   * @memberof ContentfulCdaApi
   * @param  {Object=} query - Object with search parameters. Check &lt;a href="https://www.contentful.com/developers/docs/references/content-delivery-api/#/reference/search-parameters">Search Parameters&lt;/a> for more details.
   * @param  {boolean=} query.resolveLinks - When true, links to other Entries or Assets are resolved. Default: true.
   * @return {Promise&lt;Entities.EntryCollection>} Promise for a collection of Entries
   */
  function getEntries() {
    var query = arguments.length &lt;= 0 || arguments[0] === undefined ? {} : arguments[0];

    var resolveLinks = shouldLinksResolve(query, resolveLinksGlobalSetting);
    return http.get('entries', (0, _createRequestConfig2.default)({ query: query })).then(function (response) {
      return (0, _entry.wrapEntryCollection)(response.data, resolveLinks);
    }, errorHandler);
  }

  /**
   * Gets an Asset
   * @memberof ContentfulCdaApi
   * @param  {string} id
   * @return {Promise&lt;Entities.Asset>} Promise for an Asset
   */
  function getAsset(id) {
    return http.get('assets/' + id).then(function (response) {
      return (0, _asset.wrapAsset)(response.data);
    }, errorHandler);
  }

  /**
   * Gets a collection of Assets
   * @memberof ContentfulCdaApi
   * @param  {Object=} query - Object with search parameters. Check &lt;a href="https://www.contentful.com/developers/docs/references/content-delivery-api/#/reference/search-parameters">Search Parameters&lt;/a> for more details.
   * @return {Promise&lt;Entities.AssetCollection>} Promise for a collection of Assets
   */
  function getAssets() {
    var query = arguments.length &lt;= 0 || arguments[0] === undefined ? {} : arguments[0];

    return http.get('assets', (0, _createRequestConfig2.default)({ query: query })).then(function (response) {
      return (0, _asset.wrapAssetCollection)(response.data);
    }, errorHandler);
  }

  /**
   * Synchronizes either all the content or only new content since last sync
   * See &lt;a href="https://www.contentful.com/developers/docs/concepts/sync/">Synchronization&lt;/a> for more information.
   * @memberof ContentfulCdaApi
   * @param  {Object} query - Query object for the sync call. One of initial or nextSyncToken always needs to be specified, but not both.
   * @param  {boolean?} query.initial - Indicates if this is the first sync. Use it if you don't have a sync token.
   * @param  {string?} query.nextSyncToken - The token you got the last time you used this method. Ensures you only get changed content.
   * @param  {string=} query.type - Filter by this type (Entry or Asset)
   * @param  {string=} query.content_type - Filter by this content type id
   * @param  {boolean=} query.resolveLinks - When true, links to other Entries or Assets are resolved. Default: true.
   * @return {Promise&lt;Sync.SyncCollection>} Promise for the collection resulting of a sync operation
   */
  function sync() {
    var query = arguments.length &lt;= 0 || arguments[0] === undefined ? {} : arguments[0];

    var resolveLinks = shouldLinksResolve(query, resolveLinksGlobalSetting);
    return (0, _sync2.default)(http, query, resolveLinks);
  }

  return {
    getSpace: getSpace,
    getContentType: getContentType,
    getContentTypes: getContentTypes,
    getEntry: getEntry,
    getEntries: getEntries,
    getAsset: getAsset,
    getAssets: getAssets,
    sync: sync
  };
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="contentful.html">contentful</a></li><li><a href="ContentfulCdaApi.html">ContentfulCdaApi</a></li><li><a href="Entities.html">Entities</a></li><li><a href="Fields.html">Fields</a></li><li><a href="Sync.html">Sync</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Fri Feb 19 2016 17:54:21 GMT+0100 (CET)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
